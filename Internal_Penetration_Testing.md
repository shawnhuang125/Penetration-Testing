# Internal Penetration Testing Guideness
## Step By Step
- 內網滲透測試的目標
- 識別內部網路中的安全漏洞：包括未授權存取、錯誤配置、過時的軟體和系統漏洞。
- 模擬內部威脅：測試內部使用者或受感染的內部設備對網路資源的潛在威脅。
- 評估內部安全控制：如存取控制、網路隔離、資料保護和監控機制的有效性。
- 發現潛在的橫向移動路徑：透過權限提升和橫向移動，評估攻擊者能夠在網路中擴展控制的可能性。
- 偵測和回應能力評估：評估組織對內部攻擊的偵測和回應能力。
- 2.內網滲透測試的步驟
- 2.1.資訊收集
- 目標：收集有關內部網路環境的基本信息，包括IP 位址範圍、主機名稱、作業系統、網路拓撲、裝置和應用程式等。
- 方法：
- 網路掃描：使用工具如Nmap 對內網進行連接埠掃描、作業系統辨識、服務偵測等。
- DNS 枚舉：尋找內部DNS 記錄，取得網域名稱和IP 位址的對應關係。
- 網路嗅探：使用Wireshark 等工具監聽網路流量，收集未加密的憑證、協定資訊和網路設備的通訊狀況。
- 2.2.漏洞掃描
- 目標：識別內部網路中可能存在的已知漏洞、錯誤配置和弱點。
- 方法：
- 漏洞掃描工具：使用Nessus、OpenVAS 等漏洞掃描工具對網路中的設備和系統進行全面的漏洞掃描。
- 手動驗證：對掃描結果中的關鍵漏洞進行手動驗證，確保漏洞的真實性和影響。
- 2.3.漏洞利用
- 目標：透過利用已識別的漏洞，取得對目標系統的存取權限或提升現有權限。
- 方法：
- 利用工具：使用Metasploit、Cobalt Strike 等漏洞工具執行攻擊，並取得目標系統的存取權限。
- 權限提升：利用系統或應用程式中的權限提升漏洞，從低權限使用者提升到管理員權限。
- 後門植入：在獲得高權限後，植入後門或持久化機制，維持對目標系統的持續控制。
- 2.4.橫向移動
- 目標：評估攻擊者在內網中橫向移動的能力，進一步擴大對網路資源的控制。
- 方法：
- 憑證竊取：使用Mimikatz 等工具從已攻陷的系統中提取憑證，並利用這些憑證存取其他系統。
- Pass-the-Hash 和Pass-the-Ticket：利用哈希值或Kerberos 票據在內網中橫向移動。
- 網路共享濫用：存取和利用共用資料夾、網路磁碟機或其他可存取的網路資源。
- 2.5.資料獲取與擷取
- 目標：取得和提取敏感數據，包括資料庫、文件、密碼、客戶資訊等。
- 方法：
- 資料庫提取：利用已取得的資料庫存取權限來提取敏感資料。
- 文件搜尋：在文件伺服器或工作站中搜尋和提取敏感文件或文件。
- 2.6.清理與恢復
- 目標：清理滲透測試過程中留下的痕跡，並恢復系統到測試前的狀態，確保不影響生產環境。
- 方法：
- 日誌清理：刪除或修改系統日誌、事件日誌，以清除存取痕跡。
- 後門移除：移除所有植入的後門、腳本或持久化機制，確保系統安全。
- 恢復配置：將所有變更的配置、權限設定恢復到原始狀態。
- 3.常用的內部網路滲透測試工具
- 3.1.Nmap
- 用途：網路掃描工具，用於發現網路中的活躍主機、開放連接埠、運作服務、作業系統版本等。
- 功能：連接埠掃描、服務識別、作業系統偵測、腳本掃描。
- 3.2. Nessus 和 OpenVAS
- 用途：漏洞掃描工具，用於偵測網路中的已知漏洞和錯誤配置。
- 功能：漏洞掃描、設定稽核、修補程式管理。
- 3.3. Metasploit Framework
- 用途：漏洞利用框架，提供大量的漏洞模組和後滲透利用工具。
- 功能：漏洞利用、權限提升、後滲透利用、持久化。
- 3.4.Mimic cat
- 用途：憑證竊取工具，主要用於從Windows 系統中提取明文密碼、雜湊值、Kerberos 票據等。
- 功能：憑證竊取、Pass-the-Hash、Pass-the-Ticket、權限提升。
- 3.5.BloodHound
- 用途：Active Directory 偵查工具，用於繪製和分析網域控制網路中的信任關係，協助辨識權限提升和橫向移動路徑。
- 功能：域控分析、權限關係圖譜、橫向移動路徑識別。
- 3.6.Responder
- 用途：用於網路嗅探和劫持的工具，可以捕獲和濫用網路協定中的認證請求，如LLMNR、NBT-NS。
- 功能：網路嗅探、認證劫持、哈希捕獲。
